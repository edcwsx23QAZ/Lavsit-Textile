# Устранение ошибок Email интеграции

## Ошибка: "Invalid credentials (Failure)"

Эта ошибка означает, что IMAP сервер отклонил ваши учетные данные (логин/пароль).

### Возможные причины и решения:

#### 1. Неправильный пароль

**Для Gmail:**
- ❌ **НЕ используйте** обычный пароль от аккаунта
- ✅ **Используйте** App Password (16-значный пароль приложения)

**Как создать App Password для Gmail:**
1. Перейдите в [настройки аккаунта Google](https://myaccount.google.com/)
2. Включите **двухфакторную аутентификацию** (если еще не включена)
3. Перейдите в **Безопасность** → **Двухэтапная аутентификация**
4. Прокрутите вниз до **"Пароли приложений"**
5. Выберите **"Почта"** и устройство
6. Нажмите **"Создать"**
7. **Скопируйте 16-значный пароль** (он показывается только один раз!)
8. Используйте этот пароль в настройках приложения

**Для других провайдеров:**
- Проверьте правильность пароля
- Убедитесь, что не используете пароль с пробелами в начале/конце
- Для некоторых провайдеров может потребоваться пароль приложения

#### 2. Неправильный email адрес

- Убедитесь, что email адрес введен **полностью** (например, `your-email@gmail.com`)
- Проверьте, что нет лишних пробелов
- Убедитесь, что используете правильный email (не псевдоним)

#### 3. Неправильный IMAP сервер или порт

**Проверьте настройки для вашего провайдера:**

| Провайдер | IMAP сервер | Порт | SSL/TLS |
|-----------|-------------|------|---------|
| Gmail | `imap.gmail.com` | 993 | Да |
| Яндекс | `imap.yandex.ru` | 993 | Да |
| Mail.ru | `imap.mail.ru` | 993 | Да |
| Outlook | `outlook.office365.com` | 993 | Да |

#### 4. IMAP не включен

**Для Gmail:**
1. Откройте [Gmail](https://mail.google.com)
2. Настройки (⚙️) → **"Все настройки"**
3. Вкладка **"Пересылка и POP/IMAP"**
4. Убедитесь, что **"Включить IMAP"** отмечено
5. Сохраните изменения

**Для Яндекс:**
1. Откройте [настройки Яндекс.Почты](https://mail.yandex.ru/#setup/client)
2. Включите **"Сервер входящей почты IMAP"**
3. Сохраните изменения

**Для Mail.ru:**
1. Откройте [настройки Mail.ru](https://e.mail.ru/settings/)
2. Перейдите в **"Почтовые программы"**
3. Включите IMAP
4. Сохраните изменения

#### 5. Двухфакторная аутентификация не настроена (для Gmail)

Если у вас включена двухфакторная аутентификация, вы **обязательно** должны использовать App Password, а не обычный пароль.

#### 6. Блокировка "менее безопасных приложений" (устаревшее)

⚠️ **Примечание**: Google больше не поддерживает "менее безопасные приложения". Используйте App Password.

#### 7. Проблемы с кодировкой пароля

- Убедитесь, что пароль скопирован полностью (без обрезки)
- Проверьте, что нет скрытых символов
- Попробуйте ввести пароль вручную вместо копирования

### Пошаговая проверка:

1. **Проверьте настройки в приложении:**
   - IMAP сервер: правильный адрес?
   - Порт: 993?
   - Безопасное соединение: включено?
   - Email: полный адрес?
   - Пароль: App Password (для Gmail)?

2. **Проверьте в настройках почты:**
   - IMAP включен?
   - Двухфакторная аутентификация включена (для Gmail)?
   - App Password создан (для Gmail)?

3. **Попробуйте подключиться вручную:**
   - Используйте почтовый клиент (Outlook, Thunderbird) с теми же настройками
   - Если не работает - проблема в настройках
   - Если работает - проблема может быть в приложении

### Пример правильных настроек для Gmail:

```
IMAP сервер: imap.gmail.com
Порт: 993
Безопасное соединение: Да (SSL/TLS)
Email: your-email@gmail.com
Пароль: xxxx xxxx xxxx xxxx (16 символов App Password без пробелов)
```

### Дополнительная диагностика:

Если проблема сохраняется, проверьте логи сервера. В консоли браузера (F12) или в терминале сервера вы увидите более детальную информацию об ошибке.

## Ошибка: "Application password is REQUIRED" (Mail.ru)

Эта ошибка означает, что Mail.ru требует использования пароля приложения вместо обычного пароля.

### Решение:

1. Перейдите в [настройки безопасности Mail.ru](https://id.mail.ru/profile/security)
2. Найдите раздел **"Пароли приложений"** или **"Доступ из приложений"**
3. Нажмите **"Создать пароль приложения"**
4. Выберите тип: **"Почта"** или **"IMAP"**
5. Введите название: "Lavsit Textile"
6. Нажмите **"Создать"**
7. **Скопируйте пароль** (показывается только один раз!)
8. Используйте этот пароль в настройках приложения

**Важно**: Пароль приложения отличается от обычного пароля от почты. Используйте именно пароль приложения.

### Частые ошибки:

❌ **Неправильно:**
- Использование обычного пароля для Gmail
- Использование обычного пароля для Mail.ru (требуется пароль приложения)
- Email без домена (`user` вместо `user@gmail.com`)
- Порт 143 вместо 993
- SSL/TLS выключен

✅ **Правильно:**
- App Password для Gmail
- Пароль приложения для Mail.ru
- Полный email адрес
- Порт 993 с SSL/TLS
- IMAP включен в настройках почты

